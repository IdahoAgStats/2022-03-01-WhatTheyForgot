<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Getting to know your R Setup</title>
    <meta charset="utf-8" />
    <meta name="author" content="Julia Piaskowski" />
    <meta name="date" content="2022-03-03" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Getting to know your R Setup
## ⚔ <br> and other demystifications
### Julia Piaskowski
### 2022-03-03

---





# Updating R
*(please don't do this in the middle of class)* 

**Windows**
```
library(installr); updateR() # follow prompts
```

**Mac**  Visit the [website](https://cran.r-project.org/bin/macosx/), download and install. 

**Linux**   Run in terminal: 
```
sudo apt update
sudo apt upgrade
```

---
# Updating packages

1. command line - single package:
```
devtools::update.packages("RColorBrewer") # single packges
```
2. command line - all packages:
*(don't run this unless you have the time to wait)*
```
devtools::update_packages(TRUE)
```

3. point-and-click

&lt;RStudio 'Packages' pane&gt; 

---
# Downgrade a package

Easiest way (if you know the version): 
```
devtools::install_version("RColorBrewer", "1.0.5")
```

Downgrade to a specific point in time: 
*(note that going this far back in time usually causes problems)*
```
groundhog::groundhog.library("RColorBrewer", "2010-01-01")
```
How to find the version information? Visit the package site on CRAN. 

---
.pull-left[# Where Does R Live?] 

.pull-right[![Where is Waldo?](images/where_is_waldo.jpeg)]

---
# Where the R Executable Lives

This tell us the path to R RStudio is using: 

```r
R.home()  
```

```
## [1] "/usr/lib/R"
```

```r
#file.path(R.home("bin"), "R")
```


---
# Where Your Package Libraries Live


```r
.libPaths()
```

```
## [1] "/home/jpiaskowski/R/x86_64-pc-linux-gnu-library/4.1"
## [2] "/usr/local/lib/R/site-library"                      
## [3] "/usr/lib/R/site-library"                            
## [4] "/usr/lib/R/library"
```
1. main library
1. empty
1. added via the command line and updates with `sudo apt-get update`
1. "base R packages" (what is shipped with R)

R is using all of these, in order. 

---
class: middle

```
&gt; install.packages("RColorBrewer") &gt;&gt;#

Installing package into ‘/home/jpiaskowski/R/x86_64-pc-linux-gnu-library/4.1’
(as ‘lib’ is unspecified)
```

---
class: middle, center

# terminal fun  

## [exercise]("exercises/Exercise_1.txt")

---
# What Happens When R is Started?
![r start-up schematic](images/R-startup.svg)
([lots of things](https://stat.ethz.ch/R-manual/R-devel/library/base/html/Startup.html))

--
.Renviron &amp; .Rprofile

**.Renviron**

* sets global variables: API and authentication keys
* there is often only one of these per R system, located in the home directory, but there can one per project
* do not add this to git repository! 

**.Rprofile** 
* An R script that runs every time R is opened or restarted
* there is one created automatically when R is installed at the home directory
* there may be one in each **.Rproj**, this takes precedence over others
* this often goes in the git repo

---
class: center, middle

![let's go crazy](images/prince.jpg)

---
## A possible .Rprofile

```
options(scipen=999) # force R to not use scientific notation

.First &lt;- function() {
  cat("Welcome, High Priestress of R. You are a true hero and your legend will never die")
}

library(tidyverse) # probably not a good idea 
source("scripts/file_import.R")

.Last &lt;- function() {
  cat('Praised be,  my R programmer.')
}
```

[more details](https://sodocumentation.net/r/topic/4166/-rprofile) and [more options](https://stat.ethz.ch/R-manual/R-devel/library/base/html/options.html)

---
class: center, middle

exercise

---
# Namespace conflicts
### What is going on? 


```r
library(dplyr)
```

```
## 
## Attaching package: 'dplyr'
```

```
## The following objects are masked from 'package:stats':
## 
##     filter, lag
```

```
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
```

Only one function name can be loaded into an R session. Identical function names for packages loaded earlier must be referenced like thus: `base::filter()`. 

---
# Namesapce solutions

* remove conflicting packages:
```
detach(offending_package)
```

* only require packages you will use (reconsider `library(tidyverse)`)
* load the packages with whose functions you do not want masked last
* A solution under development:
```
devtools::install_github("r-lib/conflicted")
```

```r
library(conflicted); library(dplyr)
conflict_scout()
```

```
## 2 conflicts:
## * `filter`: dplyr, stats
## * `lag`   : dplyr, stats
```

```r
conflict_prefer("filter", "dplyr")
```

```
## [conflicted] Will prefer dplyr::filter over any other package
```

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

  </body>
</html>
