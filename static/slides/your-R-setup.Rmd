---
title: "Getting to know your R Setup"
subtitle: "⚔ <br> and other demystifications"
author: "Julia Piaskowski"
date: "2022-03-03"
output:
  xaringan::moon_reader:
    lib_dir: libs
    mathjax: null
    nature:
      highlightStyle: github
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE, tidy=TRUE)
```


# Updating R
*(please don't do this in the middle of class)* 

**Windows**
```
library(installr); updateR() # follow prompts
```

**Mac**  Visit the [website](https://cran.r-project.org/bin/macosx/), download and install. 

**Linux**   Run in terminal: 
```
sudo apt update
sudo apt upgrade
```

---
# Updating packages

1. command line - single package:
```
devtools::update.packages("RColorBrewer") # single packges
```
2. command line - all packages:
*(don't run this unless you have the time to wait)*
```
devtools::update_packages(TRUE)
```

3. point-and-click

<RStudio 'Packages' pane> 

---
# Downgrade a package

Easiest way (if you know the version): 
```
devtools::install_version("RColorBrewer", "1.0.5")
```

Downgrade to a specific point in time: 
*(note that going this far back in time usually causes problems)*
```
groundhog::groundhog.library("RColorBrewer", "2010-01-01")
```
How to find the version information? Visit the package site on CRAN. 

---
.pull-left[# Where Does R Live?] 

.pull-right[![Where is Waldo?](images/where_is_waldo.jpeg)]

---
# Where the R Executable Lives

This tell us the path to R RStudio is using: 
```{r}
R.home()  
#file.path(R.home("bin"), "R")
```


---
# Where Your Package Libraries Live

```{r}
.libPaths()
```
1. main library
1. empty
1. added via the command line and updates with `sudo apt-get update`
1. "base R packages" (what is shipped with R)

R is using all of these, in order. 

---
class: middle

```
> install.packages("RColorBrewer") >>#

Installing package into ‘/home/jpiaskowski/R/x86_64-pc-linux-gnu-library/4.1’
(as ‘lib’ is unspecified)
```

---
class: middle, center

# terminal fun  

## [exercise]("exercises/Exercise_1.txt")

---
# What Happens When R is Started?
![r start-up schematic](images/R-startup.svg)
([lots of things](https://stat.ethz.ch/R-manual/R-devel/library/base/html/Startup.html))

--
.Renviron & .Rprofile

**.Renviron**

* sets global variables: API and authentication keys
* there is often only one of these per R system, located in the home directory, but there can one per project
* do not add this to git repository! 

**.Rprofile** 
* An R script that runs every time R is opened or restarted
* there is one created automatically when R is installed at the home directory
* there may be one in each **.Rproj**, this takes precedence over others
* this often goes in the git repo

---
class: center, middle

![let's go crazy](images/prince.jpg)

---
## A possible .Rprofile

```
options(scipen=999) # force R to not use scientific notation

.First <- function() {
  cat("Welcome, High Priestress of R. You are a true hero and your legend will never die")
}

library(tidyverse) # probably not a good idea 
source("scripts/file_import.R")

.Last <- function() {
  cat('Praised be,  my R programmer.')
}
```

[more details](https://sodocumentation.net/r/topic/4166/-rprofile) and [more options](https://stat.ethz.ch/R-manual/R-devel/library/base/html/options.html)

---
class: center, middle

exercise

---
# Namespace conflicts
### What is going on? 

```{r}
library(dplyr)
```

Only one function name can be loaded into an R session. Identical function names for packages loaded earlier must be referenced like thus: `base::filter()`. 

---
# Namesapce solutions

* remove conflicting packages:
```
detach(offending_package)
```

* only require packages you will use (reconsider `library(tidyverse)`)
* load the packages with whose functions you do not want masked last
* A solution under development:
```
devtools::install_github("r-lib/conflicted")
```
```{r}
library(conflicted); library(dplyr)
conflict_scout()
conflict_prefer("filter", "dplyr")
```

